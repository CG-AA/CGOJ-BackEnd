\doxysection{src/\+CROW\+\_\+\+ROUTEs/problems.hpp File Reference}
\hypertarget{problems_8hpp}{}\label{problems_8hpp}\index{src/CROW\_ROUTEs/problems.hpp@{src/CROW\_ROUTEs/problems.hpp}}


Declaration of the problems route.  


{\ttfamily \#include $<$crow.\+h$>$}\newline
{\ttfamily \#include $<$crow/middlewares/cors.\+h$>$}\newline
{\ttfamily \#include $<$nlohmann/json.\+hpp$>$}\newline
{\ttfamily \#include "{}../\+API/api.\+hpp"{}}\newline
{\ttfamily \#include "{}../include/lrucache.\+hpp"{}}\newline
Include dependency graph for problems.\+hpp\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{problems_8hpp__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{problems_8hpp__dep__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{problems_8hpp_a3b34d447ce222e94e1ebde7107cde756}{ROUTE\+\_\+problems}} (crow\+::\+App$<$ crow\+::\+CORSHandler $>$ \&\mbox{\hyperlink{main_8cpp_afce6e82e7f4ddd54d9bbf8894ccc85ab}{app}}, nlohmann\+::json \&\mbox{\hyperlink{main_8cpp_a226e5c87ec0382336e0be64e07be3723}{settings}}, std\+::string \mbox{\hyperlink{main_8cpp_a57430442c3d9a40c976af8e13ab34029}{IP}}, std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classAPIs}{APIs}} $>$ \&API, \mbox{\hyperlink{classcache_1_1lru__cache}{cache\+::lru\+\_\+cache}}$<$ int8\+\_\+t, nlohmann\+::json $>$ \&\mbox{\hyperlink{main_8cpp_a70942e25e0034f5fb506d5843198ade3}{problems\+\_\+everyone\+\_\+cache}}, std\+::atomic$<$ bool $>$ \&\mbox{\hyperlink{main_8cpp_afa2dc980a43447849a3f06722980a126}{problems\+\_\+everyone\+\_\+cache\+\_\+hit}})
\begin{DoxyCompactList}\small\item\em Configures a route for accessing a list of problems. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Declaration of the problems route. 



\doxysubsection{Function Documentation}
\Hypertarget{problems_8hpp_a3b34d447ce222e94e1ebde7107cde756}\index{problems.hpp@{problems.hpp}!ROUTE\_problems@{ROUTE\_problems}}
\index{ROUTE\_problems@{ROUTE\_problems}!problems.hpp@{problems.hpp}}
\doxysubsubsection{\texorpdfstring{ROUTE\_problems()}{ROUTE\_problems()}}
{\footnotesize\ttfamily \label{problems_8hpp_a3b34d447ce222e94e1ebde7107cde756} 
void ROUTE\+\_\+problems (\begin{DoxyParamCaption}\item[{crow\+::\+App$<$ crow\+::\+CORSHandler $>$ \&}]{app}{, }\item[{nlohmann\+::json \&}]{settings}{, }\item[{std\+::string}]{IP}{, }\item[{std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classAPIs}{APIs}} $>$ \&}]{API}{, }\item[{\mbox{\hyperlink{classcache_1_1lru__cache}{cache\+::lru\+\_\+cache}}$<$ int8\+\_\+t, nlohmann\+::json $>$ \&}]{problems\+\_\+everyone\+\_\+cache}{, }\item[{std\+::atomic$<$ bool $>$ \&}]{problems\+\_\+everyone\+\_\+cache\+\_\+hit}{}\end{DoxyParamCaption})}



Configures a route for accessing a list of problems. 

This function sets up a route "{}/problems"{} on the provided Crow application instance. It handles GET requests to fetch a list of problems, supporting pagination and role-\/based filtering. The function performs JWT verification, role extraction, and conditionally queries the database or cache based on the roles and pagination parameters.


\begin{DoxyParams}{Parameters}
{\em app} & Reference to the Crow application instance configured with CORSHandler middleware. \\
\hline
{\em settings} & JSON object containing configuration settings, used for JWT verification and role-\/based access control. \\
\hline
{\em IP} & String representing the IP address for additional security checks in JWT verification. \\
\hline
{\em API} & Unique pointer to an \doxylink{classAPIs}{APIs} instance, used for database operations. \\
\hline
{\em problems\+\_\+everyone\+\_\+cache} & Reference to an LRU cache instance for caching problems accessible to everyone. \\
\hline
{\em problems\+\_\+everyone\+\_\+cache\+\_\+hit} & Atomic boolean flag indicating whether the cache for problems accessible to everyone has been populated.\\
\hline
\end{DoxyParams}
The function begins by verifying the JWT from the request header and extracting roles. It then processes query parameters for pagination. Based on the roles and pagination, it either queries the database for problems or retrieves them from the cache. The function supports a special case where problems accessible to everyone are cached to improve performance. It returns a JSON response with the list of problems or an error message if no problems are found. 